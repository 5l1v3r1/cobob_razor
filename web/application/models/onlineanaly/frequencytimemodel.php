<?php

/**
 * Cobub Razor
 *
 * An open source mobile analytics system
 *
 * PHP versions 5
 *
 * @category  MobileAnalytics
 * @package   CobubRazor
 * @author    Cobub Team <open.cobub@gmail.com>
 * @copyright 2011-2016 NanJing Western Bridge Co.,Ltd.
 * @license   http://www.cobub.com/docs/en:razor:license GPL Version 3
 * @link      http://www.cobub.com
 * @since     Version 0.1
 */

/**
 * Frequencytimemodel Model
 *
 * @category PHP
 * @package  Model
 * @author   Cobub Team <open.cobub@gmail.com>
 * @license  http://www.cobub.com/docs/en:razor:license GPL Version 3
 * @link     http://www.cobub.com
 */
class Frequencytimemodel extends CI_Model {

    /**
     * Construct load
     * Construct function
     * 
     * @return void
     */
    function __construct() {
        parent::__construct();
        $this->load->model("product/productmodel", 'product');
        $this->load->model("channelmodel", 'channel');
        $this->load->model("servermodel", 'server');
    }
    
    function getCountday0($fromTime,$toTime,$channel,$server,$version,$usertype,$counttype,$countdatetype){
        $list = array();
        $query = $this->Countday0($fromTime,$toTime,$channel,$server,$version,$usertype,$counttype,$countdatetype);
        $dauUsersRow = $query->first_row();
        for ($i = 0; $i < $query->num_rows(); $i++) {
            $fRow = array();
            $fRow['field'] = $dauUsersRow->field;
            $fRow['rolecount'] = $dauUsersRow->rolecount;
            $fRow['rate'] = $dauUsersRow->rate;
            $dauUsersRow = $query->next_row();
            array_push($list, $fRow);
        }
        return $list;
    }

	function Countday0($fromTime,$toTime,$channel,$server,$version,$usertype,$counttype,$countdatetype)
	{
		$currentProduct = $this->common->getCurrentProduct();
		$productId= $currentProduct->id;
		$dwdb = $this->load->database('dw', true);
		($channel != 'all')?$channel_list = $this->unescape(implode("','", $channel)):$channel_list = 'all';
		($version != 'all')?$version_list = $this->unescape(implode("','", $version)):$version_list = 'all';
		($server != 'all')?$server_list = $this->unescape(implode("','", $server)):$server_list = 'all';
		$sql = "SELECT
					IFNULL(field, 0) field,
					IFNULL(SUM(rolecount), 0) rolecount,
					IFNULL(AVG(rate), 0) rate
				FROM
					" . $dwdb->dbprefix('sum_basic_frequencytime_countday') . "
				WHERE
                product_id = $productId
                AND channel_name in('" . $channel_list . "')
                AND version_name in('" . $version_list . "')
                AND server_name in('" . $server_list . "')
                AND counttype = '" . $counttype . "'
                AND countdatetype = '" . $countdatetype . "'
                AND usertype = '" . $usertype . "'
                AND startdate_sk >= '" . $fromTime . "'
                Group By field
                Order By rid ASC";
        $query = $dwdb->query($sql);
        return $query;
    }

    function getCountday1($fromTime,$toTime,$channel,$server,$version,$usertype,$countdatetype){
        $list = array();
        $query = $this->Countday1($fromTime,$toTime,$channel,$server,$version,$usertype,$countdatetype);
        $dauUsersRow = $query->first_row();
        for ($i = 0; $i < $query->num_rows(); $i++) {
            $fRow = array();
            $fRow['field'] = $dauUsersRow->field;
            $fRow['rolecount'] = $dauUsersRow->rolecount;
            $fRow['rate'] = $dauUsersRow->rate;
            $dauUsersRow = $query->next_row();
            array_push($list, $fRow);
        }
        return $list;
    }

    function Countday1($fromTime,$toTime,$channel,$server,$version,$usertype,$countdatetype)
    {
        $currentProduct = $this->common->getCurrentProduct();
        $productId= $currentProduct->id;
        $dwdb = $this->load->database('dw', true);
        ($channel != 'all')?$channel_list = $this->unescape(implode("','", $channel)):$channel_list = 'all';
        ($version != 'all')?$version_list = $this->unescape(implode("','", $version)):$version_list = 'all';
        ($server != 'all')?$server_list = $this->unescape(implode("','", $server)):$server_list = 'all';
        $sql = "SELECT
                    IFNULL(field, 0) field,
                    IFNULL(SUM(rolecount), 0) rolecount,
                    IFNULL(AVG(rate), 0) rate
                FROM
                    " . $dwdb->dbprefix('sum_basic_frequencytime_gametime') . "
                WHERE
                product_id = $productId
                AND channel_name in('" . $channel_list . "')
                AND version_name in('" . $version_list . "')
                AND server_name in('" . $server_list . "')
                AND countdatetype = '" . $countdatetype . "'
                AND usertype = '" . $usertype . "'
                AND startdate_sk >= '" . $fromTime . "'
                Group By field
                Order By rid ASC";
        $query = $dwdb->query($sql);
        return $query;
    }

    function getCountday2($fromTime,$toTime,$channel,$server,$version,$usertype){
        $list = array();
        $query = $this->Countday2($fromTime,$toTime,$channel,$server,$version,$usertype);
        $dauUsersRow = $query->first_row();
        for ($i = 0; $i < $query->num_rows(); $i++) {
            $fRow = array();
            $fRow['field'] = $dauUsersRow->field;
            $fRow['rolecount'] = $dauUsersRow->rolecount;
            $fRow['rate'] = $dauUsersRow->rate;
            $dauUsersRow = $query->next_row();
            array_push($list, $fRow);
        }
        return $list;
    }

    function Countday2($fromTime,$toTime,$channel,$server,$version,$usertype)
    {
        $currentProduct = $this->common->getCurrentProduct();
        $productId= $currentProduct->id;
        $dwdb = $this->load->database('dw', true);
        ($channel != 'all')?$channel_list = $this->unescape(implode("','", $channel)):$channel_list = 'all';
        ($version != 'all')?$version_list = $this->unescape(implode("','", $version)):$version_list = 'all';
        ($server != 'all')?$server_list = $this->unescape(implode("','", $server)):$server_list = 'all';
        $sql = "SELECT
                    IFNULL(field, 0) field,
                    IFNULL(SUM(rolecount), 0) rolecount,
                    IFNULL(AVG(rate), 0) rate
                FROM
                    " . $dwdb->dbprefix('sum_basic_frequencytime_timefield') . "
                WHERE
                product_id = $productId
                AND channel_name in('" . $channel_list . "')
                AND version_name in('" . $version_list . "')
                AND server_name in('" . $server_list . "')
                AND usertype = '" . $usertype . "'
                AND startdate_sk >= '" . $fromTime . "'
                Group By field
                Order By rid ASC";
        $query = $dwdb->query($sql);
        return $query;
    }

    /**
     * unescape 
     * 
     * @param Array $str
     * 
     * @return Array $ret
     */
    function unescape($str) {
        $ret = '';
        $len = strlen($str);
        for ($i = 0; $i < $len; $i ++) {
            if ($str[$i] == '%' && $str[$i + 1] == 'u') {
                $val = hexdec(substr($str, $i + 2, 4));
                if ($val < 0x7f)
                    $ret .= chr($val);
                else
                if ($val < 0x800)
                    $ret .= chr(0xc0 | ($val >> 6)) .
                            chr(0x80 | ($val & 0x3f));
                else
                    $ret .= chr(0xe0 | ($val >> 12)) .
                            chr(0x80 | (($val >> 6) & 0x3f)) .
                            chr(0x80 | ($val & 0x3f));
                $i += 5;
            } else
            if ($str[$i] == '%') {
                $ret .= urldecode(substr($str, $i, 3));
                $i += 2;
            } else
                $ret .= $str[$i];
        }
        return $ret;
    }

    /**
     * GetGamecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGamecount($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromlogintimes=1,$tologintimes=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

        /**
     * GetGamecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGamecountBypay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromlogintimes=1,$tologintimes=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

        /**
     * GetGamecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGamecountByunpay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromlogintimes=1,$tologintimes=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    #AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT ll.userId) rolecount
                    FROM
                        VIEW_razor_login_logintimes_srvid ll
                    WHERE
                        ll.login_date >= '$fromdate'
                    AND ll.login_date <= '$todate'
                    AND ll.appId='$appid'
                    AND ll.chId='$channelid'
                    #AND ll.srvId='$serverid'
                    #AND ll.version='$versionname'
                    AND ll.logintimes >= $fromlogintimes
                    AND ll.logintimes <= $tologintimes
                    AND ll.userId not IN (
                        SELECT DISTINCT
                            p.userId
                        FROM
                            razor_pay p
                        WHERE
                            p.pay_date >= '$fromdate'
                        AND p.pay_date <= '$todate'
                        AND p.appId = '$appid'
                        AND p.chId = '$channelid'
                        AND p.srvId = '$serverid'
                        AND p.version = '$versionname'
                    );";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGameDatecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGameDatecount($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromdatecount=1,$todatecount=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

        /**
     * GetGameDatecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGameDatecountBypay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromdatecount=1,$todatecount=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

        /**
     * GetGameDatecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGameDatecountByunpay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromdatecount=1,$todatecount=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT dc.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                COUNT(DISTINCT l.login_date) datecount
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'login'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) dc
                    WHERE
                        dc.datecount >= $fromdatecount
                    AND dc.datecount <= $todatecount;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametime function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametime($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromgametime=1,$togametime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametime function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimeBypay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromgametime=1,$togametime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )                            
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'

                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'

                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )                               
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametime function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimeByunpay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromgametime=1,$togametime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            #AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT gt.roleId) rolecount
                    FROM
                        (
                            SELECT
                                l.roleId,
                                IFNULL(SUM(l.offlineSettleTime), 0) gametime
                            FROM
                                razor_login l
                            WHERE
                                l.type = 'logout'
                            AND l.login_date >= '$fromdate'
                            AND l.login_date <= '$todate'
                            AND l.appId = '$appid'
                            AND l.chId = '$channelid'
                            #AND l.srvId = '$serverid'
                            #AND l.version = '$versionname'
                            AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                            GROUP BY
                                l.roleId
                        ) gt
                    WHERE
                        gt.gametime >= $fromgametime
                    AND gt.gametime < $togametime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimeByonecount($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromofflineSettleTime=1,$toofflineSettleTime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimeByonecountBypay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromofflineSettleTime=1,$toofflineSettleTime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimeByonecountByunpay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromofflineSettleTime=1,$toofflineSettleTime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'logout'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.offlineSettleTime >= $fromofflineSettleTime
                    AND l.offlineSettleTime < $toofflineSettleTime;";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimefield($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromtime=1,$totime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimefieldBypay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromtime=1,$totime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }

    /**
     * GetGametimeByonecount function
     * get acu
     * 
     * @param Date $date
     * @param String $appid
     * @param String $channelid
     * @param String $serverid
     * @param String $versionname
     * 
     * @return Int acu
     */
    function getGametimefieldByunpay($fromdate, $todate,$appid, $channelid = 'all', $serverid = 'all', $versionname = 'all',$fromtime=1,$totime=1) {
        if ($channelid == 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid == 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    #AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                #AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid <> 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname <> 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        } elseif ($channelid <> 'all' && $serverid == 'all' && $versionname == 'all') {
            $sql = "SELECT
                        COUNT(DISTINCT l.roleId) rolecount
                    FROM
                        razor_login l
                    WHERE
                        l.type = 'login'
                    AND l.login_date >= '$fromdate'
                    AND l.login_date <= '$todate'
                    AND l.appId = '$appid'
                    AND l.chId = '$channelid'
                    #AND l.srvId = '$serverid'
                    #AND l.version = '$versionname'
                    AND l.roleId not IN (
                                SELECT DISTINCT
                                    p.roleId
                                FROM
                                    razor_pay p
                                WHERE
                                    p.pay_date >= '$fromdate'
                                AND p.pay_date <= '$todate'
                                AND p.appId = '$appid'
                                AND p.chId = '$channelid'
                                #AND p.srvId = '$serverid'
                                #AND p.version = '$versionname'
                            )
                    AND l.login_time >= date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $fromtime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    )
                    AND l.login_time < date_format(
                        date_add(
                            DATE_SUB(CURDATE(), INTERVAL 1 DAY),
                            INTERVAL $totime HOUR
                        ),
                        '%Y-%m-%d %k:00:00'
                    );";
        }
        $query = $this->db->query($sql);
        $row = $query->first_row();
        if ($query->num_rows > 0) {
            return $row->rolecount;
        }
    }
    
    /**
     * Sum_basic_frequencytime function
     * count online users by every day
     * 
     * 
     */
    function sum_basic_frequencytime($countdate) {
        //
        $this_monday=$this->common->this_monday(0,false);
        //
        $month_firstday=$this->common->month_firstday(0,false);
        $dwdb = $this->load->database('dw', true);

        $params_psv = $this->product->getProductServerVersionOffChannel();
        $paramsRow_psv = $params_psv->first_row();
        for ($i = 0; $i < $params_psv->num_rows(); $i++) {
            //get servername by serverid
            $server_name = $this->server->getServernameById($paramsRow_psv->srvId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_psv->appId, 'all', $paramsRow_psv->srvId, $paramsRow_psv->version,23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_psv->appId,
                'version_name' => $paramsRow_psv->version,
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_psv = $params_psv->next_row();
        }
        $params_ps = $this->product->getProductServerOffChannelVersion();
        $paramsRow_ps = $params_ps->first_row();
        for ($i = 0; $i < $params_ps->num_rows(); $i++) {
            //get servername by serverid
            $server_name = $this->server->getServernameById($paramsRow_ps->srvId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_ps->appId, 'all', $paramsRow_ps->srvId, 'all',23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_ps->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_ps = $params_psv->next_row();
        }
        $params_pv = $this->product->getProductVersionOffChannelServer();
        $paramsRow_pv = $params_pv->first_row();
        for ($i = 0; $i < $params_pv->num_rows(); $i++) {
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pv->appId, 'all', 'all', $paramsRow_pv->version,23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pv->appId,
                'version_name' => $paramsRow_pv->version,
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_pv = $params_psv->next_row();
        }
        $params_p = $this->product->getProductOffChannelServerVersion();
        $paramsRow_p = $params_p->first_row();
        for ($i = 0; $i < $params_p->num_rows(); $i++) {
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_p->appId, 'all', 'all', 'all',23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_p->appId,
                'version_name' => 'all',
                'channel_name' => 'all',
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_p = $params_psv->next_row();
        }
        $params_pcsv = $this->product->getProductChannelServerVersion();
        $paramsRow_pcsv = $params_pcsv->first_row();
        for ($i = 0; $i < $params_pcsv->num_rows(); $i++) {
            //get channelname by channelid
            $channel_name = $this->channel->getChannelnameById($paramsRow_pcsv->chId);
            //get servername by serverid
            $server_name = $this->server->getServernameById($paramsRow_pcsv->srvId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcsv->appId, 'all', $paramsRow_pcsv->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcsv->appId, $paramsRow_pcsv->chId, $paramsRow_pcsv->srvId, $paramsRow_pcsv->version,23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcsv->appId,
                'version_name' => $paramsRow_pcsv->version,
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_p = $params_psv->next_row();
        }
        $params_pcs = $this->product->getProductChannelServerOffVersion();
        $paramsRow_pcs = $params_pcs->first_row();
        for ($i = 0; $i < $params_pcs->num_rows(); $i++) {
            //get channelname by channelid
            $channel_name = $this->channel->getChannelnameById($paramsRow_pcs->chId);
            //get servername by serverid
            $server_name = $this->server->getServernameById($paramsRow_pcs->srvId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcs->appId, 'all', $paramsRow_pcs->srvId, 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcs->appId, $paramsRow_pcs->chId, $paramsRow_pcs->srvId, 'all',23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcs->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => $server_name,
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_p = $params_psv->next_row();
        }
        $params_pcv = $this->product->getProductChannelVersionOffServer();
        $paramsRow_pcv = $params_pcv->first_row();
        for ($i = 0; $i < $params_pcv->num_rows(); $i++) {
            //get channelname by channelid
            $channel_name = $this->channel->getChannelnameById($paramsRow_pcv->chId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pcv->appId, $paramsRow_pcv->chId, 'all', $paramsRow_pcv->version,23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pcv->appId,
                'version_name' => $paramsRow_pcv->version,
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_p = $params_psv->next_row();
        }
        $params_pc = $this->product-> getProductChannelOffServerVersion();
        $paramsRow_pc = $params_pc->first_row();
        for ($i = 0; $i < $params_pc->num_rows(); $i++) {
            //get channelname by channelid
            $channel_name = $this->channel->getChannelnameById($paramsRow_pc->chId);
            //dauuser day
            $gamecount_dauuser_day_all= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_dauuser_day_1_1= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_dauuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_day_1_1,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_1_1/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_1_1);
            // 2
            $gamecount_dauuser_day_2_2= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamecount_dauuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_dauuser_day_2_2,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_2_2/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_2_2);
            // 3
            $gamecount_dauuser_day_3_3= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamecount_dauuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_dauuser_day_3_3,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_3_3/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_3_3);
            // 4
            $gamecount_dauuser_day_4_4= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamecount_dauuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_dauuser_day_4_4,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_4_4/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_4_4);
            // 5
            $gamecount_dauuser_day_5_5= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamecount_dauuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_dauuser_day_5_5,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_5_5/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_5_5);
            // 6-10
            $gamecount_dauuser_day_6_10= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamecount_dauuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_dauuser_day_6_10,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_6_10/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_6_10);
            // 10+
            $gamecount_dauuser_day_10_above= $this->getGamecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_dauuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_day_10_above,
                'rate' => ($gamecount_dauuser_day_all==0)?0:($gamecount_dauuser_day_10_above/$gamecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_day_10_above);
            //dauuser week
            $gamecount_dauuser_week_all= $this->getGamecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_dauuser_week_1_1= $this->getGamecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_dauuser_week_1_1,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_1_1/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_1_1);
            // 2-7
            $gamecount_dauuser_week_2_7= $this->getGamecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,7);
            $data_gamecount_dauuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_dauuser_week_2_7,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_2_7/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_2_7);
            // 8-10
            $gamecount_dauuser_week_8_10= $this->getGamecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',8,10);
            $data_gamecount_dauuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_dauuser_week_8_10,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_8_10/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_8_10);
            // 10+
            $gamecount_dauuser_week_10_above= $this->getGamecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_dauuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_dauuser_week_10_above,
                'rate' => ($gamecount_dauuser_week_all==0)?0:($gamecount_dauuser_week_10_above/$gamecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_dauuser_week_10_above);
            //dauuser day pay
            $gamecount_payuser_day_all= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_payuser_day_1_1= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_payuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_payuser_day_1_1,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_1_1/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_1_1);
            // 2
            $gamecount_payuser_day_2_2= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamecount_payuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2-2',
                'rolecount' => $gamecount_payuser_day_2_2,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_2_2/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_2_2);
            // 3
            $gamecount_payuser_day_3_3= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamecount_payuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_payuser_day_3_3,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_3_3/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_3_3);
            // 4
            $gamecount_payuser_day_4_4= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamecount_payuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_payuser_day_4_4,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_4_4/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_4_4);
            // 5
            $gamecount_payuser_day_5_5= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamecount_payuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_payuser_day_5_5,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_5_5/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_5_5);
            // 6-10
            $gamecount_payuser_day_6_10= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamecount_payuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_day_6_10,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_6_10/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_6_10);
            // 10+
            $gamecount_payuser_day_10_above= $this->getGamecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_payuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_day_10_above,
                'rate' => ($gamecount_payuser_day_all==0)?0:($gamecount_payuser_day_10_above/$gamecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_day_10_above);
            //dauuser week pay
            $gamecount_payuser_week_all= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_payuser_week_1_1= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_payuser_week_1_1,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_1_1/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_1_1);
            // 2
            $gamecount_payuser_week_2_2= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamecount_payuser_week_2_2,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_2_2/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_2_2);
            // 3
            $gamecount_payuser_week_3_3= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamecount_payuser_week_3_3,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_3_3/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_3_3);
            // 4
            $gamecount_payuser_week_4_4= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamecount_payuser_week_4_4,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_4_4/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_4_4);
            // 5
            $gamecount_payuser_week_5_5= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamecount_payuser_week_5_5,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_5_5/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_5_5);
            // 6-10
            $gamecount_payuser_week_6_10= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamecount_payuser_week_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '6-10',
                'rolecount' => $gamecount_payuser_week_6_10,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_6_10/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_6_10);
            // 10+
            $gamecount_payuser_week_10_above= $this->getGamecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_payuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_payuser_week_10_above,
                'rate' => ($gamecount_payuser_week_all==0)?0:($gamecount_payuser_week_10_above/$gamecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_payuser_week_10_above);
            //dauuser day unpay
            $gamecount_unpayuser_day_all= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_unpayuser_day_1_1= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_unpayuser_day_1_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_day_1_1,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_1_1/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_1_1);
            // 2
            $gamecount_unpayuser_day_2_2= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamecount_unpayuser_day_2_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '2',
                'rolecount' => $gamecount_unpayuser_day_2_2,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_2_2/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_2_2);
            // 3
            $gamecount_unpayuser_day_3_3= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamecount_unpayuser_day_3_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '3',
                'rolecount' => $gamecount_unpayuser_day_3_3,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_3_3/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_3_3);
            // 4
            $gamecount_unpayuser_day_4_4= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamecount_unpayuser_day_4_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '4',
                'rolecount' => $gamecount_unpayuser_day_4_4,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_4_4/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_4_4);
            // 5
            $gamecount_unpayuser_day_5_5= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamecount_unpayuser_day_5_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '5',
                'rolecount' => $gamecount_unpayuser_day_5_5,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_5_5/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_5_5);
            // 6-10
            $gamecount_unpayuser_day_6_10= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamecount_unpayuser_day_6_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '6-10',
                'rolecount' => $gamecount_unpayuser_day_6_10,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_6_10/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_6_10);
            // 10+
            $gamecount_unpayuser_day_10_above= $this->getGamecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_unpayuser_day_10_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'day',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_day_10_above,
                'rate' => ($gamecount_unpayuser_day_all==0)?0:($gamecount_unpayuser_day_10_above/$gamecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_day_10_above);
            //dauuser week unpay
            $gamecount_unpayuser_week_all= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamecount_unpayuser_week_1_1= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamecount_unpayuser_week_1_1,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_1_1/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_1_1);
            // 2-7
            $gamecount_unpayuser_week_2_7= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,7);
            $data_gamecount_unpayuser_week_2_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '2-7',
                'rolecount' => $gamecount_unpayuser_week_2_7,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_2_7/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_2_7);
            // 8-10
            $gamecount_unpayuser_week_8_10= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',8,10);
            $data_gamecount_unpayuser_week_8_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '8-10',
                'rolecount' => $gamecount_unpayuser_week_8_10,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_8_10/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_8_10);
            // 10+
            $gamecount_unpayuser_week_10_above= $this->getGamecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,1000000000);
            $data_gamecount_unpayuser_week_10_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gamecount',
                'countdatetype' => 'week',
                'field' => '10+',
                'rolecount' => $gamecount_unpayuser_week_10_above,
                'rate' => ($gamecount_unpayuser_week_all==0)?0:($gamecount_unpayuser_week_10_above/$gamecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamecount_unpayuser_week_10_above);

            //dauuser week
            $gamedatecount_dauuser_week_all= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_week_1_1= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_dauuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_week_1_1,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_1_1/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_1_1);
            // 2
            $gamedatecount_dauuser_week_2_2= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_dauuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_week_2_2,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_2_2/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_2_2);
            // 3
            $gamedatecount_dauuser_week_3_3= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_dauuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_week_3_3,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_3_3/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_3_3);
            // 4
            $gamedatecount_dauuser_week_4_4= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_dauuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_week_4_4,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_4_4/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_4_4);
            // 5
            $gamedatecount_dauuser_week_5_5= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_dauuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_week_5_5,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_5_5/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_5_5);
            // 6
            $gamedatecount_dauuser_week_6_6= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,6);
            $data_gamedatecount_dauuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_dauuser_week_6_6,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_6_6/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_6_6);
            // 7
            $gamedatecount_dauuser_week_7_7= $this->getGameDatecount($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,7);
            $data_gamedatecount_dauuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_dauuser_week_7_7,
                'rate' => ($gamedatecount_dauuser_week_all==0)?0:($gamedatecount_dauuser_week_7_7/$gamedatecount_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_week_7_7);
            //dauuser month
            $gamedatecount_dauuser_month_all= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_dauuser_month_1_1= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_dauuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_dauuser_month_1_1,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_1_1/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_1_1);
            // 2
            $gamedatecount_dauuser_month_2_2= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_dauuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_dauuser_month_2_2,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_2_2/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_2_2);
            // 3
            $gamedatecount_dauuser_month_3_3= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_dauuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_dauuser_month_3_3,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_3_3/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_3_3);
            // 4
            $gamedatecount_dauuser_month_4_4= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_dauuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_dauuser_month_4_4,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_4_4/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_4_4);
            // 5
            $gamedatecount_dauuser_month_5_5= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_dauuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_dauuser_month_5_5,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_5_5/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_5_5);
            // 6-10
            $gamedatecount_dauuser_month_6_10= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamedatecount_dauuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_dauuser_month_6_10,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_6_10/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_6_10);
            // 11-20
            $gamedatecount_dauuser_month_11_20= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,20);
            $data_gamedatecount_dauuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_dauuser_month_11_20,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_11_20/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_11_20);
            // 21-31
            $gamedatecount_dauuser_month_21_31= $this->getGameDatecount($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,31);
            $data_gamedatecount_dauuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_dauuser_month_21_31,
                'rate' => ($gamedatecount_dauuser_month_all==0)?0:($gamedatecount_dauuser_month_21_31/$gamedatecount_dauuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_dauuser_month_21_31);

            //dauuser week pay
            $gamedatecount_payuser_week_all= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_payuser_week_1_1= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_payuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_week_1_1,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_1_1/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_1_1);
            // 2
            $gamedatecount_payuser_week_2_2= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_payuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_week_2_2,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_2_2/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_2_2);
            // 3
            $gamedatecount_payuser_week_3_3= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_payuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_week_3_3,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_3_3/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_3_3);
            // 4
            $gamedatecount_payuser_week_4_4= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_payuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_week_4_4,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_4_4/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_4_4);
            // 5
            $gamedatecount_payuser_week_5_5= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_payuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_week_5_5,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_5_5/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_5_5);
            // 6
            $gamedatecount_payuser_week_6_6= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,6);
            $data_gamedatecount_payuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_payuser_week_6_6,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_6_6/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_6_6);
            // 7
            $gamedatecount_payuser_week_7_7= $this->getGameDatecountBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,7);
            $data_gamedatecount_payuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_payuser_week_7_7,
                'rate' => ($gamedatecount_payuser_week_all==0)?0:($gamedatecount_payuser_week_7_7/$gamedatecount_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_week_7_7);
            //dauuser month pay
            $gamedatecount_payuser_month_all= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_payuser_month_1_1= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_payuser_month_1_1 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_payuser_month_1_1,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_1_1/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_1_1);
            // 2
            $gamedatecount_payuser_month_2_2= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_payuser_month_2_2 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_payuser_month_2_2,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_2_2/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_2_2);
            // 3
            $gamedatecount_payuser_month_3_3= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_payuser_month_3_3 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_payuser_month_3_3,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_3_3/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_3_3);
            // 4
            $gamedatecount_payuser_month_4_4= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_payuser_month_4_4 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_payuser_month_4_4,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_4_4/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_4_4);
            // 5
            $gamedatecount_payuser_month_5_5= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_payuser_month_5_5 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_payuser_month_5_5,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_5_5/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_5_5);
            // 6-10
            $gamedatecount_payuser_month_6_10= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamedatecount_payuser_month_6_10 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_payuser_month_6_10,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_6_10/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_6_10);
            // 11-20
            $gamedatecount_payuser_month_11_20= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,20);
            $data_gamedatecount_payuser_month_11_20 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_payuser_month_11_20,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_11_20/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_11_20);
            // 21-31
            $gamedatecount_payuser_month_21_31= $this->getGameDatecountBypay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,31);
            $data_gamedatecount_payuser_month_21_31 = array(
                'startdate_sk' => $month_firstday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_payuser_month_21_31,
                'rate' => ($gamedatecount_payuser_month_all==0)?0:($gamedatecount_payuser_month_21_31/$gamedatecount_payuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_payuser_month_21_31);

            //dauuser week unpay
            $gamedatecount_unpayuser_week_all= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_week_1_1= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_unpayuser_week_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_week_1_1,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_1_1/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_1_1);
            // 2
            $gamedatecount_unpayuser_week_2_2= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_unpayuser_week_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_week_2_2,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_2_2/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_2_2);
            // 3
            $gamedatecount_unpayuser_week_3_3= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_unpayuser_week_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_week_3_3,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_3_3/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_3_3);
            // 4
            $gamedatecount_unpayuser_week_4_4= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_unpayuser_week_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_week_4_4,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_4_4/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_4_4);
            // 5
            $gamedatecount_unpayuser_week_5_5= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_unpayuser_week_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_week_5_5,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_5_5/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_5_5);
            // 6
            $gamedatecount_unpayuser_week_6_6= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,6);
            $data_gamedatecount_unpayuser_week_6_6 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '6',
                'rolecount' => $gamedatecount_unpayuser_week_6_6,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_6_6/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_6_6);
            // 7
            $gamedatecount_unpayuser_week_7_7= $this->getGameDatecountByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,7);
            $data_gamedatecount_unpayuser_week_7_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'week',
                'field' => '7',
                'rolecount' => $gamedatecount_unpayuser_week_7_7,
                'rate' => ($gamedatecount_unpayuser_week_all==0)?0:($gamedatecount_unpayuser_week_7_7/$gamedatecount_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_week_7_7);
            //dauuser month unpay
            $gamedatecount_unpayuser_month_all= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,100000000);
            // 1
            $gamedatecount_unpayuser_month_1_1= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,1);
            $data_gamedatecount_unpayuser_month_1_1 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '1',
                'rolecount' => $gamedatecount_unpayuser_month_1_1,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_1_1/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_1_1);
            // 2
            $gamedatecount_unpayuser_month_2_2= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,2);
            $data_gamedatecount_unpayuser_month_2_2 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '2',
                'rolecount' => $gamedatecount_unpayuser_month_2_2,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_2_2/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_2_2);
            // 3
            $gamedatecount_unpayuser_month_3_3= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,3);
            $data_gamedatecount_unpayuser_month_3_3 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '3',
                'rolecount' => $gamedatecount_unpayuser_month_3_3,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_3_3/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_3_3);
            // 4
            $gamedatecount_unpayuser_month_4_4= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,4);
            $data_gamedatecount_unpayuser_month_4_4 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '4',
                'rolecount' => $gamedatecount_unpayuser_month_4_4,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_4_4/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_4_4);
            // 5
            $gamedatecount_unpayuser_month_5_5= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,5);
            $data_gamedatecount_unpayuser_month_5_5 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '5',
                'rolecount' => $gamedatecount_unpayuser_month_5_5,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_5_5/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_5_5);
            // 6-10
            $gamedatecount_unpayuser_month_6_10= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,10);
            $data_gamedatecount_unpayuser_month_6_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '6-10',
                'rolecount' => $gamedatecount_unpayuser_month_6_10,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_6_10/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_6_10);
            // 11-20
            $gamedatecount_unpayuser_month_11_20= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,20);
            $data_gamedatecount_unpayuser_month_11_20 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '11-20',
                'rolecount' => $gamedatecount_unpayuser_month_11_20,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_11_20/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_11_20);
            // 21-31
            $gamedatecount_unpayuser_month_21_31= $this->getGameDatecountByunpay($month_firstday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,31);
            $data_gamedatecount_unpayuser_month_21_31 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'counttype' => 'gameday',
                'countdatetype' => 'month',
                'field' => '21-31',
                'rolecount' => $gamedatecount_unpayuser_month_21_31,
                'rate' => ($gamedatecount_unpayuser_month_all==0)?0:($gamedatecount_unpayuser_month_21_31/$gamedatecount_unpayuser_month_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_countday', $data_gamedatecount_unpayuser_month_21_31);


            //dauuser day
            $gametime_dauuser_day_all= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_day_m_1_10= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_day_m_1_10,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_1_10/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_1_10);
            // 10-30min
            $gametime_dauuser_day_m_10_30= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametime_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_dauuser_day_m_10_30,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_10_30/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_10_30);
            // 30-60min
            $gametime_dauuser_day_m_30_60= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametime_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_dauuser_day_m_30_60,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_m_30_60/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_m_30_60);
            // 1-2h
            $gametime_dauuser_day_h_1_2= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_dauuser_day_h_1_2,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_1_2/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_1_2);
            // 2-4h
            $gametime_dauuser_day_h_2_4= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_dauuser_day_h_2_4,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_2_4/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_2_4);
            // 4h+
            $gametime_dauuser_day_h_4_above= $this->getGametime($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametime_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_dauuser_day_h_4_above,
                'rate' => ($gametime_dauuser_day_all==0)?0:($gametime_dauuser_day_h_4_above/$gametime_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_day_h_4_above);
            //dauuser week
            $gametime_dauuser_week_all= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_dauuser_week_m_1_10= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_dauuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_dauuser_week_m_1_10,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_1_10/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_1_10);
            // 10-60min
            $gametime_dauuser_week_m_10_60= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,60*60);
            $data_gametime_dauuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_dauuser_week_m_10_60,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_m_10_60/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_m_10_60);
            // 1-7h
            $gametime_dauuser_week_h_1_7= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_dauuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_dauuser_week_h_1_7,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_1_7/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_1_7);
            // 7h-14h
            $gametime_dauuser_week_h_7_14= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_dauuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_dauuser_week_h_7_14,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_7_14/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_7_14);
            // 14h+
            $gametime_dauuser_week_h_14_above= $this->getGametime($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14*60*60+1,100000000);
            $data_gametime_dauuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_dauuser_week_h_14_above,
                'rate' => ($gametime_dauuser_week_all==0)?0:($gametime_dauuser_week_h_14_above/$gametime_dauuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_dauuser_week_h_14_above);
            //dauuser day pay
            $gametime_payuser_day_all= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_payuser_day_m_1_10= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_day_m_1_10,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_1_10/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_1_10);
            // 10-30min
            $gametime_payuser_day_m_10_30= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametime_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_payuser_day_m_10_30,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_10_30/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_10_30);
            // 30-60min
            $gametime_payuser_day_m_30_60= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametime_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_payuser_day_m_30_60,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_m_30_60/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_m_30_60);
            // 1-2h
            $gametime_payuser_day_h_1_2= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_payuser_day_h_1_2,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_1_2/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_1_2);
            // 2-4h
            $gametime_payuser_day_h_2_4= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_payuser_day_h_2_4,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_2_4/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_2_4);
            // 4h+
            $gametime_payuser_day_h_4_above= $this->getGametimeBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametime_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_payuser_day_h_4_above,
                'rate' => ($gametime_payuser_day_all==0)?0:($gametime_payuser_day_h_4_above/$gametime_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_day_h_4_above);
            //dauuser week pay
            $gametime_payuser_week_all= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_payuser_week_m_1_10= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_payuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_payuser_week_m_1_10,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_1_10/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_1_10);
            // 10-60min
            $gametime_payuser_week_m_10_60= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,60*60);
            $data_gametime_payuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_payuser_week_m_10_60,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_m_10_60/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_m_10_60);
            // 1-7h
            $gametime_payuser_week_h_1_7= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_payuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_payuser_week_h_1_7,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_1_7/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_1_7);
            // 7h-14h
            $gametime_payuser_week_h_7_14= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_payuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_payuser_week_h_7_14,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_7_14/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_7_14);
            // 14h+
            $gametime_payuser_week_h_14_above= $this->getGametimeBypay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14*60*60+1,100000000);
            $data_gametime_payuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_payuser_week_h_14_above,
                'rate' => ($gametime_payuser_week_all==0)?0:($gametime_payuser_week_h_14_above/$gametime_payuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_payuser_week_h_14_above);
            //dauuser day unpay
            $gametime_unpayuser_day_all= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_day_m_1_10= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_day_m_1_10,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_1_10/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_1_10);
            // 10-30min
            $gametime_unpayuser_day_m_10_30= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametime_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '10-30min',
                'rolecount' => $gametime_unpayuser_day_m_10_30,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_10_30/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_10_30);
            // 30-60min
            $gametime_unpayuser_day_m_30_60= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametime_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '30-60min',
                'rolecount' => $gametime_unpayuser_day_m_30_60,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_m_30_60/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_m_30_60);
            // 1-2h
            $gametime_unpayuser_day_h_1_2= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametime_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '1-2h',
                'rolecount' => $gametime_unpayuser_day_h_1_2,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_1_2/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_1_2);
            // 2-4h
            $gametime_unpayuser_day_h_2_4= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametime_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '2-4h',
                'rolecount' => $gametime_unpayuser_day_h_2_4,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_2_4/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_2_4);
            // 4h+
            $gametime_unpayuser_day_h_4_above= $this->getGametimeByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametime_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'day',
                'field' => '4h+',
                'rolecount' => $gametime_unpayuser_day_h_4_above,
                'rate' => ($gametime_unpayuser_day_all==0)?0:($gametime_unpayuser_day_h_4_above/$gametime_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_day_h_4_above);
            //dauuser week unpay
            $gametime_unpayuser_week_all= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,100000000);
            // 1-10min
            $gametime_unpayuser_week_m_1_10= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,10*60);
            $data_gametime_unpayuser_week_m_1_10 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-10min',
                'rolecount' => $gametime_unpayuser_week_m_1_10,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_1_10/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_1_10);
            // 10-60min
            $gametime_unpayuser_week_m_10_60= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,60*60);
            $data_gametime_unpayuser_week_m_10_60 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '10-60min',
                'rolecount' => $gametime_unpayuser_week_m_10_60,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_m_10_60/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_m_10_60);
            // 1-7h
            $gametime_unpayuser_week_h_1_7= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,7*60*60);
            $data_gametime_unpayuser_week_h_1_7 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '1-7h',
                'rolecount' => $gametime_unpayuser_week_h_1_7,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_1_7/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_1_7);
            // 7h-14h
            $gametime_unpayuser_week_h_7_14= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7*60*60+1,14*60*60);
            $data_gametime_unpayuser_week_h_7_14 = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '7h-14h',
                'rolecount' => $gametime_unpayuser_week_h_7_14,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_7_14/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_7_14);
            // 14h+
            $gametime_unpayuser_week_h_14_above= $this->getGametimeByunpay($this_monday, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14*60*60+1,100000000);
            $data_gametime_unpayuser_week_h_14_above = array(
                'startdate_sk' => $this_monday,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'week',
                'field' => '14h+',
                'rolecount' => $gametime_unpayuser_week_h_14_above,
                'rate' => ($gametime_unpayuser_week_all==0)?0:($gametime_unpayuser_week_h_14_above/$gametime_unpayuser_week_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametime_unpayuser_week_h_14_above);

            //dauuser day
            $gametimebyonecount_dauuser_day_all= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_dauuser_day_m_0_1= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_dauuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_0_1,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_0_1/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_dauuser_day_m_1_10= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_dauuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_1_10,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_1_10/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_dauuser_day_m_10_30= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_dauuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_10_30,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_10_30/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_dauuser_day_m_30_60= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_dauuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_dauuser_day_m_30_60,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_m_30_60/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_dauuser_day_h_1_2= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_dauuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_1_2,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_1_2/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_dauuser_day_h_2_4= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_dauuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_dauuser_day_h_2_4,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_2_4/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_dauuser_day_h_4_above= $this->getGametimeByonecount($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_dauuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_dauuser_day_h_4_above,
                'rate' => ($gametimebyonecount_dauuser_day_all==0)?0:($gametimebyonecount_dauuser_day_h_4_above/$gametimebyonecount_dauuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_dauuser_day_h_4_above);

            //dauuser day pay
            $gametimebyonecount_payuser_day_all= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_payuser_day_m_0_1= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_payuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_payuser_day_m_0_1,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_0_1/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_payuser_day_m_1_10= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_payuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_payuser_day_m_1_10,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_1_10/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_payuser_day_m_10_30= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_payuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_payuser_day_m_10_30,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_10_30/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_payuser_day_m_30_60= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_payuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_payuser_day_m_30_60,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_m_30_60/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_payuser_day_h_1_2= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_payuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_payuser_day_h_1_2,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_1_2/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_payuser_day_h_2_4= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_payuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_payuser_day_h_2_4,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_2_4/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_payuser_day_h_4_above= $this->getGametimeByonecountBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_payuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_payuser_day_h_4_above,
                'rate' => ($gametimebyonecount_payuser_day_all==0)?0:($gametimebyonecount_payuser_day_h_4_above/$gametimebyonecount_payuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_payuser_day_h_4_above);

            //dauuser day unpay
            $gametimebyonecount_unpayuser_day_all= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60,100000000);
            // 1min
            $gametimebyonecount_unpayuser_day_m_0_1= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0*60,1*60);
            $data_gametimebyonecount_unpayuser_day_m_0_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_0_1,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_0_1/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_0_1);
            // 1-10min
            $gametimebyonecount_unpayuser_day_m_1_10= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60+1,10*60);
            $data_gametimebyonecount_unpayuser_day_m_1_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-10min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_1_10,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_1_10/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_1_10);
            // 10-30min
            $gametimebyonecount_unpayuser_day_m_10_30= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10*60+1,30*60);
            $data_gametimebyonecount_unpayuser_day_m_10_30 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '10-30min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_10_30,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_10_30/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_10_30);
            // 30-60min
            $gametimebyonecount_unpayuser_day_m_30_60= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',30*60+1,60*60);
            $data_gametimebyonecount_unpayuser_day_m_30_60 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '30-60min',
                'rolecount' => $gametimebyonecount_unpayuser_day_m_30_60,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_m_30_60/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_m_30_60);
            // 1-2h
            $gametimebyonecount_unpayuser_day_h_1_2= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1*60*60+1,2*60*60);
            $data_gametimebyonecount_unpayuser_day_h_1_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '1-2h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_1_2,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_1_2/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_1_2);
            // 2-4h
            $gametimebyonecount_unpayuser_day_h_2_4= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2*60*60+1,4*60*60);
            $data_gametimebyonecount_unpayuser_day_h_2_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '2-4h',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_2_4,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_2_4/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_2_4);
            // 4h+
            $gametimebyonecount_unpayuser_day_h_4_above= $this->getGametimeByonecountByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4*60*60+1,100000000);
            $data_gametimebyonecount_unpayuser_day_h_4_above = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'countdatetype' => 'onecount',
                'field' => '4h+',
                'rolecount' => $gametimebyonecount_unpayuser_day_h_4_above,
                'rate' => ($gametimebyonecount_unpayuser_day_all==0)?0:($gametimebyonecount_unpayuser_day_h_4_above/$gametimebyonecount_unpayuser_day_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_gametime', $data_gametimebyonecount_unpayuser_day_h_4_above);

            //dauuser day
            $gametimefield_dauuser_all= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,24);
            $gametimefield_dauuser_0= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,1);
            $data_gametimefield_dauuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '0',
                'rolecount' => $gametimefield_dauuser_0,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_0/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_0);
            $gametimefield_dauuser_1= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,2);
            $data_gametimefield_dauuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '1',
                'rolecount' => $gametimefield_dauuser_1,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_1/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_1);
            $gametimefield_dauuser_2= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,3);
            $data_gametimefield_dauuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '2',
                'rolecount' => $gametimefield_dauuser_2,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_2/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_2);
            $gametimefield_dauuser_3= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,4);
            $data_gametimefield_dauuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '3',
                'rolecount' => $gametimefield_dauuser_3,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_3/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_3);
            $gametimefield_dauuser_4= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,5);
            $data_gametimefield_dauuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '4',
                'rolecount' => $gametimefield_dauuser_4,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_4/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_4);
            $gametimefield_dauuser_5= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,6);
            $data_gametimefield_dauuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '5',
                'rolecount' => $gametimefield_dauuser_5,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_5/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_5);
            $gametimefield_dauuser_6= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,7);
            $data_gametimefield_dauuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '6',
                'rolecount' => $gametimefield_dauuser_6,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_6/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_6);
            $gametimefield_dauuser_7= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,8);
            $data_gametimefield_dauuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '7',
                'rolecount' => $gametimefield_dauuser_7,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_7/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_7);
            $gametimefield_dauuser_8= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',8,9);
            $data_gametimefield_dauuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '8',
                'rolecount' => $gametimefield_dauuser_8,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_8/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_8);
            $gametimefield_dauuser_9= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',9,10);
            $data_gametimefield_dauuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '9',
                'rolecount' => $gametimefield_dauuser_9,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_9/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_9);
            $gametimefield_dauuser_10= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10,11);
            $data_gametimefield_dauuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '10',
                'rolecount' => $gametimefield_dauuser_10,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_10/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_10);
            $gametimefield_dauuser_11= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,12);
            $data_gametimefield_dauuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '11',
                'rolecount' => $gametimefield_dauuser_11,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_11/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_11);
            $gametimefield_dauuser_12= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',12,13);
            $data_gametimefield_dauuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '12',
                'rolecount' => $gametimefield_dauuser_12,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_12/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_12);
            $gametimefield_dauuser_13= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',13,14);
            $data_gametimefield_dauuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '13',
                'rolecount' => $gametimefield_dauuser_13,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_13/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_13);
            $gametimefield_dauuser_14= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14,15);
            $data_gametimefield_dauuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '14',
                'rolecount' => $gametimefield_dauuser_14,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_14/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_14);
            $gametimefield_dauuser_15= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',15,16);
            $data_gametimefield_dauuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '15',
                'rolecount' => $gametimefield_dauuser_15,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_15/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_15);
            $gametimefield_dauuser_16= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',16,17);
            $data_gametimefield_dauuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '16',
                'rolecount' => $gametimefield_dauuser_16,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_16/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_16);
            $gametimefield_dauuser_17= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',17,18);
            $data_gametimefield_dauuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '17',
                'rolecount' => $gametimefield_dauuser_17,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_17/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_17);
            $gametimefield_dauuser_18= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',18,19);
            $data_gametimefield_dauuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '18',
                'rolecount' => $gametimefield_dauuser_18,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_18/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_18);
            $gametimefield_dauuser_19= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',19,20);
            $data_gametimefield_dauuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '19',
                'rolecount' => $gametimefield_dauuser_19,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_19/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_19);
            $gametimefield_dauuser_20= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',20,21);
            $data_gametimefield_dauuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '20',
                'rolecount' => $gametimefield_dauuser_20,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_20/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_20);
            $gametimefield_dauuser_21= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,22);
            $data_gametimefield_dauuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '21',
                'rolecount' => $gametimefield_dauuser_21,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_21/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_21);
            $gametimefield_dauuser_22= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',22,23);
            $data_gametimefield_dauuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '22',
                'rolecount' => $gametimefield_dauuser_22,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_22/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_22);
            $gametimefield_dauuser_23= $this->getGametimefield($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',23,24);
            $data_gametimefield_dauuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'dauuser',
                'field' => '23',
                'rolecount' => $gametimefield_dauuser_23,
                'rate' => ($gametimefield_dauuser_all==0)?0:($gametimefield_dauuser_23/$gametimefield_dauuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_dauuser_23);
            //dauuser day pay
            $gametimefield_payuser_all= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,24);
            $gametimefield_payuser_0= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,1);
            $data_gametimefield_payuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '0',
                'rolecount' => $gametimefield_payuser_0,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_0/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_0);
            $gametimefield_payuser_1= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,2);
            $data_gametimefield_payuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '1',
                'rolecount' => $gametimefield_payuser_1,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_1/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_1);
            $gametimefield_payuser_2= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,3);
            $data_gametimefield_payuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '2',
                'rolecount' => $gametimefield_payuser_2,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_2/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_2);
            $gametimefield_payuser_3= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,4);
            $data_gametimefield_payuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '3',
                'rolecount' => $gametimefield_payuser_3,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_3/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_3);
            $gametimefield_payuser_4= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,5);
            $data_gametimefield_payuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '4',
                'rolecount' => $gametimefield_payuser_4,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_4/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_4);
            $gametimefield_payuser_5= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,6);
            $data_gametimefield_payuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '5',
                'rolecount' => $gametimefield_payuser_5,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_5/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_5);
            $gametimefield_payuser_6= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,7);
            $data_gametimefield_payuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '6',
                'rolecount' => $gametimefield_payuser_6,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_6/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_6);
            $gametimefield_payuser_7= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,8);
            $data_gametimefield_payuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '7',
                'rolecount' => $gametimefield_payuser_7,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_7/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_7);
            $gametimefield_payuser_8= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',8,9);
            $data_gametimefield_payuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '8',
                'rolecount' => $gametimefield_payuser_8,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_8/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_8);
            $gametimefield_payuser_9= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',9,10);
            $data_gametimefield_payuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '9',
                'rolecount' => $gametimefield_payuser_9,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_9/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_9);
            $gametimefield_payuser_10= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10,11);
            $data_gametimefield_payuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '10',
                'rolecount' => $gametimefield_payuser_10,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_10/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_10);
            $gametimefield_payuser_11= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,12);
            $data_gametimefield_payuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '11',
                'rolecount' => $gametimefield_payuser_11,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_11/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_11);
            $gametimefield_payuser_12= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',12,13);
            $data_gametimefield_payuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '12',
                'rolecount' => $gametimefield_payuser_12,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_12/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_12);
            $gametimefield_payuser_13= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',13,14);
            $data_gametimefield_payuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '13',
                'rolecount' => $gametimefield_payuser_13,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_13/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_13);
            $gametimefield_payuser_14= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14,15);
            $data_gametimefield_payuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '14',
                'rolecount' => $gametimefield_payuser_14,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_14/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_14);
            $gametimefield_payuser_15= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',15,16);
            $data_gametimefield_payuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '15',
                'rolecount' => $gametimefield_payuser_15,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_15/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_15);
            $gametimefield_payuser_16= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',16,17);
            $data_gametimefield_payuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '16',
                'rolecount' => $gametimefield_payuser_16,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_16/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_16);
            $gametimefield_payuser_17= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',17,18);
            $data_gametimefield_payuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '17',
                'rolecount' => $gametimefield_payuser_17,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_17/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_17);
            $gametimefield_payuser_18= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',18,19);
            $data_gametimefield_payuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '18',
                'rolecount' => $gametimefield_payuser_18,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_18/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_18);
            $gametimefield_payuser_19= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',19,20);
            $data_gametimefield_payuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '19',
                'rolecount' => $gametimefield_payuser_19,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_19/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_19);
            $gametimefield_payuser_20= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',20,21);
            $data_gametimefield_payuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '20',
                'rolecount' => $gametimefield_payuser_20,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_20/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_20);
            $gametimefield_payuser_21= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,22);
            $data_gametimefield_payuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '21',
                'rolecount' => $gametimefield_payuser_21,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_21/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_21);
            $gametimefield_payuser_22= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',22,23);
            $data_gametimefield_payuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '22',
                'rolecount' => $gametimefield_payuser_22,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_22/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_22);
            $gametimefield_payuser_23= $this->getGametimefieldBypay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',23,24);
            $data_gametimefield_payuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'payuser',
                'field' => '23',
                'rolecount' => $gametimefield_payuser_23,
                'rate' => ($gametimefield_payuser_all==0)?0:($gametimefield_payuser_23/$gametimefield_payuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_payuser_23);
            //dauuser day unpay
            $gametimefield_unpayuser_all= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,24);
            $gametimefield_unpayuser_0= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',0,1);
            $data_gametimefield_unpayuser_0 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '0',
                'rolecount' => $gametimefield_unpayuser_0,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_0/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_0);
            $gametimefield_unpayuser_1= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',1,2);
            $data_gametimefield_unpayuser_1 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '1',
                'rolecount' => $gametimefield_unpayuser_1,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_1/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_1);
            $gametimefield_unpayuser_2= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',2,3);
            $data_gametimefield_unpayuser_2 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '2',
                'rolecount' => $gametimefield_unpayuser_2,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_2/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_2);
            $gametimefield_unpayuser_3= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',3,4);
            $data_gametimefield_unpayuser_3 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '3',
                'rolecount' => $gametimefield_unpayuser_3,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_3/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_3);
            $gametimefield_unpayuser_4= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',4,5);
            $data_gametimefield_unpayuser_4 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '4',
                'rolecount' => $gametimefield_unpayuser_4,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_4/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_4);
            $gametimefield_unpayuser_5= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',5,6);
            $data_gametimefield_unpayuser_5 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '5',
                'rolecount' => $gametimefield_unpayuser_5,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_5/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_5);
            $gametimefield_unpayuser_6= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',6,7);
            $data_gametimefield_unpayuser_6 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '6',
                'rolecount' => $gametimefield_unpayuser_6,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_6/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_6);
            $gametimefield_unpayuser_7= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',7,8);
            $data_gametimefield_unpayuser_7 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '7',
                'rolecount' => $gametimefield_unpayuser_7,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_7/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_7);
            $gametimefield_unpayuser_8= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',8,9);
            $data_gametimefield_unpayuser_8 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '8',
                'rolecount' => $gametimefield_unpayuser_8,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_8/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_8);
            $gametimefield_unpayuser_9= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',9,10);
            $data_gametimefield_unpayuser_9 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '9',
                'rolecount' => $gametimefield_unpayuser_9,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_9/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_9);
            $gametimefield_unpayuser_10= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',10,11);
            $data_gametimefield_unpayuser_10 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '10',
                'rolecount' => $gametimefield_unpayuser_10,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_10/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_10);
            $gametimefield_unpayuser_11= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',11,12);
            $data_gametimefield_unpayuser_11 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '11',
                'rolecount' => $gametimefield_unpayuser_11,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_11/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_11);
            $gametimefield_unpayuser_12= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',12,13);
            $data_gametimefield_unpayuser_12 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '12',
                'rolecount' => $gametimefield_unpayuser_12,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_12/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_12);
            $gametimefield_unpayuser_13= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',13,14);
            $data_gametimefield_unpayuser_13 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '13',
                'rolecount' => $gametimefield_unpayuser_13,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_13/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_13);
            $gametimefield_unpayuser_14= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',14,15);
            $data_gametimefield_unpayuser_14 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '14',
                'rolecount' => $gametimefield_unpayuser_14,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_14/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_14);
            $gametimefield_unpayuser_15= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',15,16);
            $data_gametimefield_unpayuser_15 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '15',
                'rolecount' => $gametimefield_unpayuser_15,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_15/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_15);
            $gametimefield_unpayuser_16= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',16,17);
            $data_gametimefield_unpayuser_16 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '16',
                'rolecount' => $gametimefield_unpayuser_16,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_16/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_16);
            $gametimefield_unpayuser_17= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',17,18);
            $data_gametimefield_unpayuser_17 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '17',
                'rolecount' => $gametimefield_unpayuser_17,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_17/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_17);
            $gametimefield_unpayuser_18= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',18,19);
            $data_gametimefield_unpayuser_18 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '18',
                'rolecount' => $gametimefield_unpayuser_18,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_18/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_18);
            $gametimefield_unpayuser_19= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',19,20);
            $data_gametimefield_unpayuser_19 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '19',
                'rolecount' => $gametimefield_unpayuser_19,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_19/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_19);
            $gametimefield_unpayuser_20= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',20,21);
            $data_gametimefield_unpayuser_20 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '20',
                'rolecount' => $gametimefield_unpayuser_20,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_20/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_20);
            $gametimefield_unpayuser_21= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',21,22);
            $data_gametimefield_unpayuser_21 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '21',
                'rolecount' => $gametimefield_unpayuser_21,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_21/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_21);
            $gametimefield_unpayuser_22= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',22,23);
            $data_gametimefield_unpayuser_22 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '22',
                'rolecount' => $gametimefield_unpayuser_22,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_22/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_22);
            $gametimefield_unpayuser_23= $this->getGametimefieldByunpay($countdate, $countdate, $paramsRow_pc->appId, $paramsRow_pc->chId, 'all', 'all',23,24);
            $data_gametimefield_unpayuser_23 = array(
                'startdate_sk' => $countdate,
                'enddate_sk' => $countdate,
                'product_id' => $paramsRow_pc->appId,
                'version_name' => 'all',
                'channel_name' => $channel_name,
                'server_name' => 'all',
                'usertype' => 'unpayuser',
                'field' => '23',
                'rolecount' => $gametimefield_unpayuser_23,
                'rate' => ($gametimefield_unpayuser_all==0)?0:($gametimefield_unpayuser_23/$gametimefield_unpayuser_all)
            );
            $dwdb->insert_or_update('razor_sum_basic_frequencytime_timefield', $data_gametimefield_unpayuser_23);

            $paramsRow_p = $params_psv->next_row();
        }
    }
}
